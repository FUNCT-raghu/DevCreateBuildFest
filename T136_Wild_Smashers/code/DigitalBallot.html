<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigitalBallot - Electronic Voting Machine</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #2d3748;
            height: 100vh;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .evm-screen {
            width: 100%;
            min-height: 100vh;
            background: #ffffff;
            border: 8px solid #2d3748;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            margin: 10px;
            max-width: calc(100vw - 20px);
        }
        
        .status-bar {
            background: linear-gradient(135deg, #1a202c, #2d3748);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #fff;
            font-size: 14px;
            border-radius: 4px 4px 0 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .eci-logo-small {
            display: flex;
            align-items: center;
            font-weight: 700;
            font-size: 16px;
        }
        
        .logo-icon {
            background: linear-gradient(135deg, #ff9933, #ff6b35);
            padding: 8px;
            border-radius: 8px;
            margin-right: 12px;
            font-size: 18px;
        }
        
        .status-indicators {
            display: flex;
            gap: 24px;
            font-size: 13px;
        }
        
        .indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .indicator.active {
            background: rgba(56, 161, 105, 0.2);
            color: #68d391;
        }
        
        .evm-header {
            background: linear-gradient(135deg, #ff9933 0%, #ffffff 50%, #138808 100%);
            padding: 32px 24px;
            text-align: center;
            border-bottom: 4px solid #ff9933;
            position: relative;
            overflow: hidden;
        }
        
        .evm-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            pointer-events: none;
        }
        
        .evm-title {
            font-size: 28px;
            font-weight: 800;
            color: #1a365d;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }
        
        .evm-subtitle {
            font-size: 16px;
            color: #2d3748;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }
        
        .content-container {
            padding: 40px 32px;
            max-width: 1200px;
            margin: 0 auto;
            min-height: calc(100vh - 200px);
            overflow-y: auto;
        }
        
        .step-progress {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 32px;
            position: relative;
        }
        
        .step-progress::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 2px;
            background: #e2e8f0;
            z-index: 0;
        }
        
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 40px;
            color: #a0aec0;
            font-size: 14px;
            font-weight: 600;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }
        
        .step-item.active {
            color: #3182ce;
            transform: scale(1.05);
        }
        
        .step-item.completed {
            color: #38a169;
        }
        
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ffffff;
            border: 3px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .step-item.active .step-circle {
            background: #3182ce;
            border-color: #3182ce;
            color: #fff;
            box-shadow: 0 6px 20px rgba(49, 130, 206, 0.3);
        }
        
        .step-item.completed .step-circle {
            background: #38a169;
            border-color: #38a169;
            color: #fff;
            box-shadow: 0 6px 20px rgba(56, 161, 105, 0.3);
        }
        
        .scanner-section {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .biometric-scanner {
            width: 140px;
            height: 140px;
            border: 4px solid #e2e8f0;
            border-radius: 50%;
            margin: 0 auto 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .biometric-scanner::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, transparent, rgba(59, 130, 246, 0.3), transparent);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .biometric-scanner:hover {
            border-color: #3182ce;
            transform: scale(1.05);
            box-shadow: 0 12px 40px rgba(49, 130, 206, 0.2);
        }
        
        .biometric-scanner:hover::before {
            opacity: 1;
        }
        
        .biometric-scanner.scanning {
            border-color: #3182ce;
            animation: scanPulse 2s infinite;
        }
        
        @keyframes scanPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 8px 32px rgba(49, 130, 206, 0.2);
            }
            50% { 
                transform: scale(1.03);
                box-shadow: 0 12px 40px rgba(49, 130, 206, 0.4);
            }
        }
        
        .scanner-icon {
            font-size: 56px;
            color: #3182ce;
            transition: all 0.3s ease;
        }
        
        .biometric-scanner:hover .scanner-icon {
            color: #2c5aa0;
        }
        
        .scanner-status {
            margin: 32px 0;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .status-main {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }
        
        .status-sub {
            font-size: 16px;
            color: #718096;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .progress-section {
            width: 100%;
            max-width: 500px;
            margin: 32px auto;
            display: none;
        }
        
        .progress-section.visible {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 16px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3182ce, #63b3ed);
            width: 0%;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        
        .progress-text {
            font-size: 14px;
            color: #718096;
            text-align: center;
            font-weight: 500;
        }
        
        .evm-button {
            background: linear-gradient(135deg, #3182ce, #2c5aa0);
            color: #fff;
            border: none;
            padding: 18px 36px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 24px rgba(49, 130, 206, 0.3);
            position: relative;
            overflow: hidden;
            min-width: 200px;
        }
        
        .evm-button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .evm-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(49, 130, 206, 0.4);
        }
        
        .evm-button:hover::before {
            opacity: 1;
        }
        
        .evm-button:active {
            transform: translateY(0);
        }
        
        .evm-button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 12px rgba(160, 174, 192, 0.2);
        }
        
        .results-section {
            margin-top: 40px;
            display: none;
        }
        
        .results-section.visible {
            display: block;
            animation: fadeInUp 0.6s ease-out;
        }
        
        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 32px;
            padding: 24px;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .result-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }
        
        .result-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 24px;
            font-size: 24px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .result-icon.success {
            background: linear-gradient(135deg, #38a169, #48bb78);
            color: #fff;
        }
        
        .result-icon.error {
            background: linear-gradient(135deg, #e53e3e, #f56565);
            color: #fff;
        }
        
        .result-icon.warning {
            background: linear-gradient(135deg, #ed8936, #f6ad55);
            color: #fff;
        }
        
        .result-text h3 {
            font-size: 24px;
            color: #2d3748;
            margin-bottom: 6px;
            font-weight: 700;
        }
        
        .result-text p {
            font-size: 16px;
            color: #718096;
            font-weight: 500;
        }
        
        .voter-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .detail-card {
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .detail-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e0;
        }
        
        .detail-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .detail-value {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
        }
        
        .candidates-section {
            margin-top: 40px;
            display: none;
        }
        
        .candidates-section.visible {
            display: block;
            animation: fadeInUp 0.7s ease-out;
        }
        
        .candidates-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 3px solid #3182ce;
            position: relative;
        }
        
        .candidates-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, #3182ce, #63b3ed);
            border-radius: 2px;
        }
        
        .candidates-list {
            display: grid;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .candidate-card {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .candidate-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #3182ce, #63b3ed);
            transition: left 0.3s ease;
        }
        
        .candidate-card:hover {
            border-color: #3182ce;
            box-shadow: 0 8px 32px rgba(49, 130, 206, 0.15);
            transform: translateY(-4px) scale(1.02);
        }
        
        .candidate-card:hover::before {
            left: 0;
        }
        
        .candidate-card:active {
            transform: translateY(-2px) scale(1.01);
        }
        
        .candidate-photo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #e2e8f0;
            margin-right: 24px;
            flex-shrink: 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .candidate-card:hover .candidate-photo {
            border-color: #3182ce;
            transform: scale(1.05);
        }
        
        .candidate-photo-fallback {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 700;
            margin-right: 24px;
            flex-shrink: 0;
            border: 4px solid #e2e8f0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .candidate-info {
            flex: 1;
            margin-right: 20px;
        }
        
        .candidate-name {
            font-size: 20px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 4px;
        }
        
        .candidate-party {
            font-size: 16px;
            color: #718096;
            font-weight: 500;
        }
        
        .candidate-symbol {
            font-size: 56px;
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            flex-shrink: 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .candidate-card:hover .candidate-symbol {
            background: linear-gradient(135deg, #e6fffa, #c6f6d5);
            border-color: #38a169;
            transform: scale(1.05);
        }
        
        .constituency-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 24px;
            text-align: center;
            border: 2px solid #5a67d8;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .constituency-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate 10s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .constituency-name {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }
        
        .constituency-code {
            font-size: 14px;
            opacity: 0.9;
            letter-spacing: 2px;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: #ffffff;
            border-radius: 20px;
            padding: 40px;
            max-width: 560px;
            width: 90%;
            text-align: center;
            border: 3px solid #ff9933;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        
        .modal-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ed8936, #f6ad55);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 36px;
            color: #fff;
            box-shadow: 0 8px 24px rgba(237, 137, 54, 0.3);
        }
        
        .modal-title {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
        }
        
        .modal-message {
            font-size: 18px;
            color: #4a5568;
            margin-bottom: 32px;
            line-height: 1.6;
        }
        
        .candidate-preview {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
            display: flex;
            align-items: center;
            text-align: left;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }
        
        .preview-photo {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #2d3748;
            margin-right: 24px;
            flex-shrink: 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .preview-photo-fallback {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            margin-right: 24px;
            flex-shrink: 0;
            border: 4px solid #2d3748;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .preview-info {
            flex: 1;
        }
        
        .preview-info h4 {
            font-size: 22px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 6px;
        }
        
        .preview-info p {
            font-size: 16px;
            color: #718096;
            margin-bottom: 6px;
        }
        
        .preview-symbol {
            font-size: 72px;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #ffffff;
            border-radius: 12px;
            border: 2px solid #cbd5e0;
            flex-shrink: 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 32px;
        }
        
        .confirm-btn {
            background: linear-gradient(135deg, #38a169, #48bb78);
            color: #fff;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(56, 161, 105, 0.3);
        }
        
        .confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(56, 161, 105, 0.4);
        }
        
        .cancel-btn {
            background: linear-gradient(135deg, #e53e3e, #f56565);
            color: #fff;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(229, 62, 62, 0.3);
        }
        
        .cancel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(229, 62, 62, 0.4);
        }
        
        .success-modal .modal-content {
            border-color: #38a169;
        }
        
        .success-icon {
            background: linear-gradient(135deg, #38a169, #48bb78);
        }
        
        .receipt-box {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            margin: 24px 0;
            text-align: left;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }
        
        .receipt-title {
            font-size: 16px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 8px;
        }
        
        .receipt-details {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            font-size: 14px;
            color: #4a5568;
            line-height: 1.8;
        }
        
        @media (max-width: 768px) {
            .content-container {
                padding: 24px 20px;
            }
            
            .step-progress {
                flex-direction: column;
                gap: 20px;
                align-items: center;
            }
            
            .step-item {
                margin: 0;
                flex-direction: row;
                gap: 12px;
            }
            
            .step-circle {
                margin-bottom: 0;
            }
            
            .voter-details {
                grid-template-columns: 1fr;
            }
            
            .candidate-card {
                flex-direction: column;
                text-align: center;
                padding: 24px 20px;
            }
            
            .candidate-photo, .candidate-photo-fallback {
                margin-right: 0;
                margin-bottom: 16px;
            }
            
            .candidate-info {
                margin-right: 0;
                margin-bottom: 16px;
            }
            
            .candidate-symbol {
                margin-left: 0;
            }
            
            .candidate-preview {
                flex-direction: column;
                text-align: center;
            }
            
            .preview-photo, .preview-photo-fallback {
                margin-right: 0;
                margin-bottom: 16px;
            }
            
            .preview-symbol {
                margin-left: 0;
                margin-top: 16px;
            }
            
            .modal-buttons {
                flex-direction: column;
                gap: 12px;
            }
            
            .modal-content {
                padding: 32px 24px;
            }
        }
        
        .focus-visible {
            outline: 3px solid #3182ce;
            outline-offset: 2px;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .loading {
            position: relative;
            overflow: hidden;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 1.5s infinite;
        }
        
        @media (prefers-contrast: high) {
            .evm-screen {
                border-color: #000;
                border-width: 4px;
            }
            
            .candidate-card {
                border-color: #000;
                border-width: 3px;
            }
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="evm-screen">
        <div class="status-bar">
            <div class="eci-logo-small">
                <div class="logo-icon">
                    <i class="fas fa-vote-yea"></i>
                </div>
                DIGITALBALLOT SYSTEM
            </div>
            <div class="status-indicators">
                <div class="indicator active">
                    <i class="fas fa-wifi"></i>
                    <span>ONLINE</span>
                </div>
                <div class="indicator active">
                    <i class="fas fa-shield-alt"></i>
                    <span>SECURE</span>
                </div>
                <div class="indicator active">
                    <i class="fas fa-battery-full"></i>
                    <span>POWER</span>
                </div>
            </div>
        </div>

        <div class="evm-header">
            <h1 class="evm-title">DigitalBallot System</h1>
            <p class="evm-subtitle">Election Commission of India - Digital Voting Platform</p>
        </div>

        <div class="content-container">
            <div class="step-progress" role="progressbar" aria-label="Voting Process Progress">
                <div class="step-item active" id="step-1">
                    <div class="step-circle">1</div>
                    <span>AUTHENTICATE</span>
                </div>
                <div class="step-item" id="step-2">
                    <div class="step-circle">2</div>
                    <span>VERIFY</span>
                </div>
                <div class="step-item" id="step-3">
                    <div class="step-circle">3</div>
                    <span>VOTE</span>
                </div>
            </div>

            <div class="scanner-section">
                <div class="biometric-scanner" id="biometric-scanner" role="button" tabindex="0" 
                     aria-label="Biometric Scanner - Click or press Enter to start scanning">
                    <i class="fas fa-fingerprint scanner-icon" aria-hidden="true"></i>
                </div>

                <div class="scanner-status">
                    <div class="status-main" id="status-main">Ready for Authentication</div>
                    <div class="status-sub" id="status-sub">Click the scanner above or use the button below to begin</div>
                </div>

                <div class="progress-section" id="progress-section" role="progressbar" aria-label="Scanning Progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Processing...</div>
                </div>
            </div>

            <div style="text-align: center; margin-bottom: 40px;">
                <button class="evm-button" id="scan-button" aria-describedby="button-description">
                    <span id="button-text">
                        <i class="fas fa-fingerprint" aria-hidden="true"></i> Start Biometric Scan
                    </span>
                    <span id="button-loading" style="display: none;" aria-live="polite">
                        <i class="fas fa-spinner fa-spin" aria-hidden="true"></i> Scanning...
                    </span>
                </button>
                <div id="button-description" class="sr-only">
                    Press this button to initiate the biometric fingerprint scanning process
                </div>
            </div>

            <div class="results-section" id="results-section" role="region" aria-label="Verification Results">
                <div class="result-header">
                    <div class="result-icon" id="result-icon" aria-hidden="true">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="result-text">
                        <h3 id="result-title">Verification Successful</h3>
                        <p id="result-message">Identity confirmed and verified</p>
                    </div>
                </div>

                <div class="voter-details" id="voter-details" role="region" aria-label="Voter Information">
                </div>

                <div class="constituency-banner" id="constituency-banner" style="display: none;" 
                     role="banner" aria-label="Constituency Information">
                    <div class="constituency-name" id="constituency-display">Lucknow Central</div>
                    <div class="constituency-code">Constituency Code: LC-001</div>
                </div>

                <div class="candidates-section" id="candidates-section" role="region" aria-label="Candidate Selection">
                    <h3 class="candidates-title">Select Your Candidate</h3>
                    <div class="candidates-list" id="candidates-list" role="radiogroup" aria-label="Available Candidates">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="confirmation-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-content">
            <div class="modal-icon" aria-hidden="true">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h2 class="modal-title" id="modal-title">Confirm Your Vote</h2>
            <p class="modal-message">
                You are about to cast your vote for the following candidate. 
                <strong>This action cannot be undone.</strong> Please confirm your selection.
            </p>
            
            <div class="candidate-preview" id="candidate-preview" role="region" aria-label="Selected Candidate Preview">
                <div id="preview-photo-container"></div>
                <div class="preview-info">
                    <h4 id="preview-name">Dr. Rajesh Kumar</h4>
                    <p id="preview-party">Progressive Alliance</p>
                    <p style="font-weight: 600; color: #2d3748;">Party Symbol:</p>
                </div>
                <div class="preview-symbol" id="preview-symbol" aria-label="Party Symbol">üèõÔ∏è</div>
            </div>
            
            <div class="modal-buttons">
                <button class="confirm-btn" id="confirm-vote">
                    <i class="fas fa-check-circle" aria-hidden="true"></i> Yes, Cast My Vote
                </button>
                <button class="cancel-btn" id="cancel-vote">
                    <i class="fas fa-times-circle" aria-hidden="true"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay success-modal" id="success-modal" role="dialog" aria-modal="true" aria-labelledby="success-title">
        <div class="modal-content">
            <div class="modal-icon success-icon" aria-hidden="true">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="modal-title" id="success-title">Vote Recorded Successfully</h2>
            <p class="modal-message" id="success-message">Your vote has been securely recorded in the DigitalBallot system.</p>
            
            <div class="receipt-box" role="region" aria-label="Vote Receipt">
                <div class="receipt-title">DigitalBallot Receipt</div>
                <div class="receipt-details">
                    <div>Reference ID: <span id="transaction-id"></span></div>
                    <div>Date & Time: <span id="vote-timestamp"></span></div>
                    <div>Constituency: <span id="receipt-constituency"></span></div>
                    <div>Candidate: <span id="selected-candidate"></span></div>
                    <div>Status: <span style="color: #38a169;">Confirmed</span></div>
                </div>
            </div>
            
            <button class="evm-button" id="close-modal">
                Complete Process
            </button>
        </div>
    </div>

    <script>
        const constituencyData = {
            'Lucknow Central': {
                code: 'LC-001',
                candidates: [
                    { id: 'LC001', name: 'Dr. Rajesh Kumar', party: 'Progressive Alliance', symbol: 'üèõÔ∏è', photo: 'https://images.unsplash.com/photo-1560250097-0b93528c311a?w=200&h=200&fit=crop&crop=face' },
                    { id: 'LC002', name: 'Ms. Priya Sharma', party: 'Unity Party', symbol: 'üå∏', photo: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=200&h=200&fit=crop&crop=face' },
                    { id: 'LC003', name: 'Mr. Vikram Singh', party: 'People\'s Front', symbol: 'üåæ', photo: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Jaipur North': {
                code: 'JN-002',
                candidates: [
                    { id: 'JN001', name: 'Mrs. Lakshmi Nair', party: 'Democratic Union', symbol: 'üïäÔ∏è', photo: 'https://images.unsplash.com/photo-1551836022-deb4988cc6c0?w=200&h=200&fit=crop&crop=face' },
                    { id: 'JN002', name: 'Mr. Arjun Patel', party: 'Reform Party', symbol: 'üåü', photo: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&crop=face' },
                    { id: 'JN003', name: 'Ms. Kavya Gupta', party: 'Social Alliance', symbol: 'üå∫', photo: 'https://images.unsplash.com/photo-1494790108755-2616b332c9e5?w=200&h=200&fit=crop&crop=face' },
                    { id: 'JN004', name: 'Dr. Ramesh Yadav', party: 'Progressive Alliance', symbol: '‚≠ê', photo: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Varanasi South': {
                code: 'VS-003',
                candidates: [
                    { id: 'VS001', name: 'Pandit Mohan Sharma', party: 'Heritage Party', symbol: 'üïâÔ∏è', photo: 'https://images.unsplash.com/photo-1582750433449-648ed127bb54?w=200&h=200&fit=crop&crop=face' },
                    { id: 'VS002', name: 'Mrs. Geeta Devi', party: 'Women\'s Front', symbol: 'üåª', photo: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=200&h=200&fit=crop&crop=face' },
                    { id: 'VS003', name: 'Dr. Suresh Tiwari', party: 'Progressive Alliance', symbol: 'üè∫', photo: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Patna East': {
                code: 'PE-004',
                candidates: [
                    { id: 'PE001', name: 'Mr. Nitish Sinha', party: 'Regional Party', symbol: 'üåæ', photo: 'https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?w=200&h=200&fit=crop&crop=face' },
                    { id: 'PE002', name: 'Dr. Anita Kumari', party: 'Education First', symbol: 'üìö', photo: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=200&h=200&fit=crop&crop=face' },
                    { id: 'PE003', name: 'Mr. Ravi Kumar', party: 'Unity Party', symbol: 'ü§ù', photo: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=200&h=200&fit=crop&crop=face' },
                    { id: 'PE004', name: 'Ms. Priyanka Singh', party: 'Youth Movement', symbol: 'üöÄ', photo: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Kanpur West': {
                code: 'KW-005',
                candidates: [
                    { id: 'KW001', name: 'Mr. Ashok Gupta', party: 'Industrial Party', symbol: 'üè≠', photo: 'https://images.unsplash.com/photo-1566492031773-4f4e44671d66?w=200&h=200&fit=crop&crop=face' },
                    { id: 'KW002', name: 'Mrs. Sunita Agarwal', party: 'Trade Union', symbol: '‚öôÔ∏è', photo: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=200&h=200&fit=crop&crop=face' },
                    { id: 'KW003', name: 'Dr. Manoj Tiwari', party: 'Progressive Alliance', symbol: 'üíº', photo: 'https://images.unsplash.com/photo-1618077360395-f3068be8e001?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Bhopal Central': {
                code: 'BC-006',
                candidates: [
                    { id: 'BC001', name: 'Mrs. Kamala Devi', party: 'Central Party', symbol: 'üèõÔ∏è', photo: 'https://images.unsplash.com/photo-1607990281513-2c110a25bd8c?w=200&h=200&fit=crop&crop=face' },
                    { id: 'BC002', name: 'Mr. Sanjay Sharma', party: 'Reform Alliance', symbol: 'üîÑ', photo: 'https://images.unsplash.com/photo-1654110455429-cf322b40a906?w=200&h=200&fit=crop&crop=face' },
                    { id: 'BC003', name: 'Dr. Rekha Patel', party: 'Health First', symbol: '‚öïÔ∏è', photo: 'https://images.unsplash.com/photo-1594824804732-5f7b83d87c89?w=200&h=200&fit=crop&crop=face' },
                    { id: 'BC004', name: 'Mr. Rahul Chouhan', party: 'Tribal Front', symbol: 'üå≥', photo: 'https://images.unsplash.com/photo-1607914862516-0db7ccc10f89?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Indore North': {
                code: 'IN-007',
                candidates: [
                    { id: 'IN001', name: 'Ms. Deepika Jain', party: 'Business Party', symbol: 'üí∞', photo: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=200&h=200&fit=crop&crop=faces' },
                    { id: 'IN002', name: 'Mr. Rohit Malhotra', party: 'Tech Alliance', symbol: 'üíª', photo: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=200&h=200&fit=crop&crop=faces' },
                    { id: 'IN003', name: 'Dr. Pooja Agrawal', party: 'Progressive Alliance', symbol: 'üî¨', photo: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Delhi South': {
                code: 'DS-008',
                candidates: [
                    { id: 'DS001', name: 'Mr. Amit Gupta', party: 'Capital Party', symbol: 'üèôÔ∏è', photo: 'https://images.unsplash.com/photo-1550525811-e5869dd03032?w=200&h=200&fit=crop&crop=face' },
                    { id: 'DS002', name: 'Ms. Neha Sharma', party: 'Metro Alliance', symbol: 'üöá', photo: 'https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=200&h=200&fit=crop&crop=face' },
                    { id: 'DS003', name: 'Dr. Vinay Kumar', party: 'Development Front', symbol: 'üèóÔ∏è', photo: 'https://images.unsplash.com/photo-1556157382-97eda2d62296?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Mumbai North': {
                code: 'MN-009',
                candidates: [
                    { id: 'MN001', name: 'Mrs. Meera Patel', party: 'Coastal Party', symbol: 'üåä', photo: 'https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?w=200&h=200&fit=crop&crop=face' },
                    { id: 'MN002', name: 'Mr. Karan Shah', party: 'Economic Union', symbol: 'üìà', photo: 'https://images.unsplash.com/photo-1560250097-0b93528c311a?w=200&h=200&fit=crop&crop=faces' },
                    { id: 'MN003', name: 'Dr. Shreya Joshi', party: 'Progressive Alliance', symbol: 'üåê', photo: 'https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=200&h=200&fit=crop&crop=face' }
                ]
            },
            'Chennai South': {
                code: 'CS-010',
                candidates: [
                    { id: 'CS001', name: 'Mr. Rajesh Murugan', party: 'Southern Alliance', symbol: 'üå¥', photo: 'https://images.unsplash.com/photo-1558222218-b7b54eede3f3?w=200&h=200&fit=crop&crop=face' },
                    { id: 'CS002', name: 'Mrs. Priya Krishnan', party: 'Cultural Front', symbol: 'üé≠', photo: 'https://images.unsplash.com/photo-1500917293891-ef795e70e1f6?w=200&h=200&fit=crop&crop=face' },
                    { id: 'CS003', name: 'Dr. Arun Nadar', party: 'Tech City Party', symbol: 'üîß', photo: 'https://images.unsplash.com/photo-1592334873219-42ca023e48ce?w=200&h=200&fit=crop&crop=face' }
                ]
            }
        };

        const eligibleVoters = [
            { id: 'VOT001', name: 'Raghvendra Singh', age: 28, constituency: 'Lucknow Central', station: 'PS-012' },
            { id: 'VOT002', name: 'Rachit Sharma', age: 24, constituency: 'Jaipur North', station: 'PS-034' },
            { id: 'VOT003', name: 'Shyam Pathak', age: 35, constituency: 'Varanasi South', station: 'PS-067' },
            { id: 'VOT004', name: 'Sumit Kumar', age: 25, constituency: 'Patna East', station: 'PS-089' },
            { id: 'VOT005', name: 'Priyanka Yadav', age: 26, constituency: 'Kanpur West', station: 'PS-156' },
            { id: 'VOT006', name: 'Vikas Kumar', age: 29, constituency: 'Bhopal Central', station: 'PS-201' },
            { id: 'VOT007', name: 'Anjali Sharma', age: 23, constituency: 'Indore North', station: 'PS-145' },
            { id: 'VOT008', name: 'Rohit Agarwal', age: 31, constituency: 'Delhi South', station: 'PS-301' },
            { id: 'VOT009', name: 'Deepika Singh', age: 27, constituency: 'Mumbai North', station: 'PS-402' },
            { id: 'VOT010', name: 'Arjun Mishra', age: 33, constituency: 'Chennai South', station: 'PS-503' },
            { id: 'VOT011', name: 'Kavya Jain', age: 22, constituency: 'Jaipur North', station: 'PS-035' },
            { id: 'VOT012', name: 'Manish Gupta', age: 29, constituency: 'Lucknow Central', station: 'PS-013' },
            { id: 'VOT013', name: 'Pooja Tiwari', age: 24, constituency: 'Varanasi South', station: 'PS-068' },
            { id: 'VOT014', name: 'Ravi Yadav', age: 30, constituency: 'Patna East', station: 'PS-090' },
            { id: 'VOT015', name: 'Neha Patel', age: 26, constituency: 'Bhopal Central', station: 'PS-202' },
            { id: 'VOT016', name: 'Sanjay Kumar', age: 32, constituency: 'Kanpur West', station: 'PS-157' },
            { id: 'VOT017', name: 'Meera Sharma', age: 25, constituency: 'Indore North', station: 'PS-146' },
            { id: 'VOT018', name: 'Vinay Singh', age: 28, constituency: 'Delhi South', station: 'PS-302' },
            { id: 'VOT019', name: 'Shreya Agarwal', age: 23, constituency: 'Mumbai North', station: 'PS-403' },
            { id: 'VOT020', name: 'Arun Kumar', age: 34, constituency: 'Chennai South', station: 'PS-504' }
        ];

        const underageVoters = [
            { id: 'VOT021', name: 'Rinkee Sinha', age: 16, constituency: 'Delhi South', station: 'PS-305' },
            { id: 'VOT022', name: 'Mohan Gupta', age: 17, constituency: 'Mumbai North', station: 'PS-406' },
            { id: 'VOT023', name: 'Kavya Patel', age: 15, constituency: 'Chennai South', station: 'PS-507' },
            { id: 'VOT024', name: 'Rahul Sharma', age: 16, constituency: 'Lucknow Central', station: 'PS-015' },
            { id: 'VOT025', name: 'Priya Mishra', age: 17, constituency: 'Jaipur North', station: 'PS-037' }
        ];

        let currentVoter = null;
        let isProcessing = false;
        let selectedCandidate = null;
        let scanCount = 0;
        let votedSet = new Set();

        function getInitials(name) {
            return name.split(' ').map(word => word[0]).join('').toUpperCase();
        }

        function createPhotoElement(candidate, className) {
            const container = document.createElement('div');
            
            const img = document.createElement('img');
            img.className = className;
            img.src = candidate.photo;
            img.alt = candidate.name;
            img.style.display = 'block';
            
            const fallback = document.createElement('div');
            fallback.className = className.replace('photo', 'photo-fallback');
            fallback.textContent = getInitials(candidate.name);
            fallback.style.display = 'none';
            
            img.onerror = function() {
                img.style.display = 'none';
                fallback.style.display = 'flex';
            };
            
            container.appendChild(img);
            container.appendChild(fallback);
            
            return container;
        }

        function selectRandomVoter() {
            scanCount++;
            console.log(`=== DigitalBallot Scan ${scanCount} ===`);
            
            const showUnderage = Math.random() < 0.25;
            
            if (showUnderage) {
                const randomIndex = Math.floor(Math.random() * underageVoters.length);
                const voter = { ...underageVoters[randomIndex] };
                console.log(`Selected UNDERAGE voter: ${voter.name} (${voter.age} years)`);
                return voter;
            } else {
                const randomIndex = Math.floor(Math.random() * eligibleVoters.length);
                const voter = { ...eligibleVoters[randomIndex] };
                console.log(`Selected ELIGIBLE voter: ${voter.name} (${voter.age} years) from ${voter.constituency}`);
                return voter;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const scanButton = document.getElementById('scan-button');
            const scanner = document.getElementById('biometric-scanner');
            const closeModal = document.getElementById('close-modal');
            const confirmVote = document.getElementById('confirm-vote');
            const cancelVote = document.getElementById('cancel-vote');

            scanButton.addEventListener('click', startScan);
            scanner.addEventListener('click', startScan);
            scanner.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    startScan();
                }
            });
            
            closeModal.addEventListener('click', closeSuccessModal);
            confirmVote.addEventListener('click', confirmVoteAction);
            cancelVote.addEventListener('click', cancelVoteAction);
            
            document.addEventListener('keydown', function(e) {
                const confirmationModal = document.getElementById('confirmation-modal');
                const successModal = document.getElementById('success-modal');
                
                if (confirmationModal.classList.contains('visible') && e.key === 'Escape') {
                    cancelVoteAction();
                }
                
                if (successModal.classList.contains('visible') && e.key === 'Escape') {
                    closeSuccessModal();
                }
            });
            
            scanner.addEventListener('focus', function() {
                this.style.outline = '3px solid #3182ce';
                this.style.outlineOffset = '2px';
            });
            
            scanner.addEventListener('blur', function() {
                this.style.outline = 'none';
            });

            console.log('üó≥Ô∏è DigitalBallot System initialized successfully');
        });

        async function startScan() {
            if (isProcessing) return;

            isProcessing = true;
            updateStep(2);
            
            const scanner = document.getElementById('biometric-scanner');
            const scanButton = document.getElementById('scan-button');
            const buttonText = document.getElementById('button-text');
            const buttonLoading = document.getElementById('button-loading');
            const progressSection = document.getElementById('progress-section');

            scanner.classList.add('scanning');
            scanButton.disabled = true;
            scanButton.classList.add('loading');
            buttonText.style.display = 'none';
            buttonLoading.style.display = 'inline';
            progressSection.classList.add('visible');

            const statusMain = document.getElementById('status-main');
            statusMain.setAttribute('aria-live', 'polite');

            await simulateScanning();
            processVerification();

            scanner.classList.remove('scanning');
            scanButton.disabled = false;
            scanButton.classList.remove('loading');
            buttonText.style.display = 'inline';
            buttonLoading.style.display = 'none';
            progressSection.classList.remove('visible');
            
            isProcessing = false;
        }

        function simulateScanning() {
            return new Promise((resolve) => {
                const steps = [
                    { progress: 15, text: 'DigitalBallot scanner initializing...', ariaText: 'Scanner initialization started' },
                    { progress: 35, text: 'Capturing fingerprint image...', ariaText: 'Capturing your fingerprint' },
                    { progress: 55, text: 'Processing biometric data...', ariaText: 'Processing captured data' },
                    { progress: 75, text: 'Verifying against database...', ariaText: 'Verifying your identity' },
                    { progress: 95, text: 'Finalizing verification...', ariaText: 'Completing verification process' },
                    { progress: 100, text: 'Verification complete', ariaText: 'Verification completed successfully' }
                ];

                let currentStep = 0;

                const updateProgress = () => {
                    if (currentStep >= steps.length) {
                        resolve();
                        return;
                    }

                    const step = steps[currentStep];
                    const progressFill = document.getElementById('progress-fill');
                    const progressText = document.getElementById('progress-text');
                    const statusMain = document.getElementById('status-main');
                    
                    progressFill.style.width = step.progress + '%';
                    progressFill.setAttribute('aria-valuenow', step.progress);
                    progressText.textContent = step.text;
                    statusMain.textContent = step.text;

                    currentStep++;
                    setTimeout(updateProgress, 800);
                };

                updateProgress();
            });
        }

        function processVerification() {
            const voter = selectRandomVoter();
            currentVoter = voter;

            const resultsSection = document.getElementById('results-section');
            const statusMain = document.getElementById('status-main');
            const statusSub = document.getElementById('status-sub');

            populateVoterInfo(voter);

            console.log(`Processing: Age ${voter.age}, Voted before? ${votedSet.has(voter.id)}`);

            if (voter.age < 18) {
                showResult('error', 'Ineligible Voter', 'Age requirement not met for voting.');
                statusMain.textContent = 'Verification Failed - Underage';
                statusSub.textContent = `Voter is ${voter.age} years old (minimum: 18 years)`;
                console.log('‚Üí RESULT: INELIGIBLE (underage) - NO CANDIDATES SHOWN');
            } else if (votedSet.has(voter.id)) {
                showResult('warning', 'Already Voted', 'This voter has already participated in this election.');
                statusMain.textContent = 'Verification Failed - Duplicate Vote';
                statusSub.textContent = 'This voter has already cast their ballot';
                console.log('‚Üí RESULT: ALREADY VOTED - NO CANDIDATES SHOWN');
            } else {
                updateStep(3);
                showResult('success', 'Identity Verified', 'Voter authentication successful.');
                statusMain.textContent = 'Authentication Successful';
                statusSub.textContent = 'Please select your preferred candidate below';
                showConstituencyAndCandidates(voter);
                console.log('‚Üí RESULT: ELIGIBLE TO VOTE - CANDIDATES SHOWN');
            }

            resultsSection.classList.add('visible');
            
            setTimeout(() => {
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 200);
        }

        function showConstituencyAndCandidates(voter) {
            const constituencyBanner = document.getElementById('constituency-banner');
            const constituencyDisplay = document.getElementById('constituency-display');
            const candidatesSection = document.getElementById('candidates-section');
            const candidatesList = document.getElementById('candidates-list');

            const constituencyInfo = constituencyData[voter.constituency];
            if (constituencyInfo) {
                constituencyDisplay.textContent = voter.constituency;
                document.querySelector('.constituency-code').textContent = `Constituency Code: ${constituencyInfo.code}`;
                constituencyBanner.style.display = 'block';

                candidatesList.innerHTML = '';
                
                console.log(`Loading ${constituencyInfo.candidates.length} candidates for ${voter.constituency}`);

                constituencyInfo.candidates.forEach((candidate, index) => {
                    const candidateEl = document.createElement('div');
                    candidateEl.className = 'candidate-card';
                    candidateEl.setAttribute('role', 'radio');
                    candidateEl.setAttribute('aria-checked', 'false');
                    candidateEl.setAttribute('tabindex', index === 0 ? '0' : '-1');
                    candidateEl.setAttribute('aria-label', `${candidate.name}, ${candidate.party}, Symbol: ${candidate.symbol}`);
                    
                    const photoElement = createPhotoElement(candidate, 'candidate-photo');
                    
                    candidateEl.appendChild(photoElement);
                    candidateEl.innerHTML += `
                        <div class="candidate-info">
                            <div class="candidate-name">${candidate.name}</div>
                            <div class="candidate-party">${candidate.party}</div>
                        </div>
                        <div class="candidate-symbol" aria-label="Party symbol">${candidate.symbol}</div>
                    `;
                    
                    candidateEl.addEventListener('click', () => showConfirmation(candidate));
                    candidateEl.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            showConfirmation(candidate);
                        }
                    });
                    
                    candidatesList.appendChild(candidateEl);
                });

                candidatesSection.classList.add('visible');
            }
        }

        function showResult(type, title, message) {
            const resultIcon = document.getElementById('result-icon');
            const resultTitle = document.getElementById('result-title');
            const resultMessage = document.getElementById('result-message');

            resultIcon.className = `result-icon ${type}`;
            
            if (type === 'success') {
                resultIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
                resultIcon.setAttribute('aria-label', 'Success');
            } else if (type === 'warning') {
                resultIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                resultIcon.setAttribute('aria-label', 'Warning');
            } else {
                resultIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
                resultIcon.setAttribute('aria-label', 'Error');
            }
            
            resultTitle.textContent = title;
            resultMessage.textContent = message;
        }

        function populateVoterInfo(voter) {
            const voterDetails = document.getElementById('voter-details');
            const matchScore = (Math.random() * 5 + 95).toFixed(1);
            
            voterDetails.innerHTML = `
                <div class="detail-card">
                    <div class="detail-label">Full Name</div>
                    <div class="detail-value">${voter.name}</div>
                </div>
                <div class="detail-card">
                    <div class="detail-label">Age</div>
                    <div class="detail-value">${voter.age} years</div>
                </div>
                <div class="detail-card">
                    <div class="detail-label">Voter ID</div>
                    <div class="detail-value">${voter.id}</div>
                </div>
                <div class="detail-card">
                    <div class="detail-label">Constituency</div>
                    <div class="detail-value">${voter.constituency}</div>
                </div>
                <div class="detail-card">
                    <div class="detail-label">Polling Station</div>
                    <div class="detail-value">${voter.station}</div>
                </div>
                <div class="detail-card">
                    <div class="detail-label">Match Score</div>
                    <div class="detail-value">${matchScore}%</div>
                </div>
            `;
        }

        function showConfirmation(candidate) {
            selectedCandidate = candidate;
            
            const photoContainer = document.getElementById('preview-photo-container');
            photoContainer.innerHTML = '';
            
            const previewPhotoElement = createPhotoElement(candidate, 'preview-photo');
            photoContainer.appendChild(previewPhotoElement);
            
            document.getElementById('preview-name').textContent = candidate.name;
            document.getElementById('preview-party').textContent = candidate.party;
            document.getElementById('preview-symbol').textContent = candidate.symbol;
            
            const modal = document.getElementById('confirmation-modal');
            modal.classList.add('visible');
            
            setTimeout(() => {
                document.getElementById('confirm-vote').focus();
            }, 100);
        }

        function confirmVoteAction() {
            if (selectedCandidate) {
                document.getElementById('confirmation-modal').classList.remove('visible');
                castVote(selectedCandidate);
            }
        }

        function cancelVoteAction() {
            selectedCandidate = null;
            document.getElementById('confirmation-modal').classList.remove('visible');
        }

        function castVote(candidate) {
            votedSet.add(currentVoter.id);
            
            console.log(`‚úÖ DIGITALBALLOT VOTE CAST: ${currentVoter.name} ‚Üí ${candidate.name} in ${currentVoter.constituency}`);

            const transactionId = 'DB' + Date.now().toString(36).toUpperCase();
            const timestamp = new Date().toLocaleString('en-IN', {
                timeZone: 'Asia/Kolkata',
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });

            document.getElementById('success-message').textContent = 
                `Your vote for ${candidate.name} (${candidate.party}) has been securely recorded in the DigitalBallot system.`;
            document.getElementById('transaction-id').textContent = transactionId;
            document.getElementById('vote-timestamp').textContent = timestamp;
            document.getElementById('receipt-constituency').textContent = currentVoter.constituency;
            document.getElementById('selected-candidate').textContent = `${candidate.name} - ${candidate.party}`;

            const successModal = document.getElementById('success-modal');
            successModal.classList.add('visible');
            
            setTimeout(() => {
                document.getElementById('close-modal').focus();
            }, 100);
        }

        function updateStep(stepNumber) {
            for (let i = 1; i <= 3; i++) {
                const step = document.getElementById(`step-${i}`);
                if (i < stepNumber) {
                    step.className = 'step-item completed';
                } else if (i === stepNumber) {
                    step.className = 'step-item active';
                } else {
                    step.className = 'step-item';
                }
            }
        }

        function closeSuccessModal() {
            document.getElementById('success-modal').classList.remove('visible');
            
            setTimeout(() => {
                resetSystem();
            }, 500);
        }

        function resetSystem() {
            currentVoter = null;
            selectedCandidate = null;
            updateStep(1);
            
            document.getElementById('results-section').classList.remove('visible');
            document.getElementById('candidates-section').classList.remove('visible');
            document.getElementById('constituency-banner').style.display = 'none';
            document.getElementById('status-main').textContent = 'DigitalBallot Ready';
            document.getElementById('status-sub').textContent = 'Preparing for next voter...';
            
            document.querySelector('.content-container').scrollTop = 0;
            
            setTimeout(() => {
                document.getElementById('status-main').textContent = 'Ready for Authentication';
                document.getElementById('status-sub').textContent = 'Click the scanner above or use the button below to begin';
                
                document.getElementById('scan-button').focus();
            }, 2000);
        }
    </script>
</body>
</html>
